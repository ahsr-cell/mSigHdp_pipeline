// Profile details
manifest {
    author          = "Andrew Ramos"
    name            = "mSigHDP pipeline"
    description     = "Signature extraction via mSigHdp pipeline. Contact Andrew at ar39@sanger.ac.uk for any queries."
    mainScript      = 'main.nf'
    nextflowVersion = '!>=24.04.2'
    version         = "0.0.1"
}

params {
    image_cachedir = "${projectDir}/images"

    // Pipeline options
    mutational_matrix = null
    hierarchy = false
    hierarchy_matrix = null
    mutational_context = null
    plotting = true
    decompose = true
    outdir = null

    // mSigHdp options
    analysis_type = "analysis"
    hierarchy_parameter = null
    burnin_iterations = 5000
    burnin_multiplier = 10
    posterior = 250
    posterior_iterations = 100

}

profiles {
    debug {
        dumpHashes              = true
        process.beforeScript    = 'echo $HOSTNAME'
        cleanup                 = false
        nextflow.enable.configProcessNamesValidation = true
    }
    docker {
        docker.enabled          = true
        includeConfig 'conf/container.config'
        conda.enabled           = false
        singularity.enabled     = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        apptainer.enabled       = false
        docker.runOptions       = '-u $(id -u):$(id -g)'
    }
    arm {
        docker.runOptions       = '-u $(id -u):$(id -g) --platform=linux/amd64'
    }
    singularity {
        singularity.enabled = true
        singularity.autoMounts = true
        includeConfig 'conf/container.config'
        singularity.cacheDir = params.image_cachedir
        singularity.runOptions = '--cleanenv --no-home'
        conda.enabled           = false
        docker.enabled          = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        apptainer.enabled       = false
    }
    podman {
        podman.enabled          = true
        conda.enabled           = false
        docker.enabled          = false
        singularity.enabled     = false
        shifter.enabled         = false
        charliecloud.enabled    = false
        apptainer.enabled       = false
    }
    shifter {
        shifter.enabled         = true
        includeConfig 'conf/container.config'
        conda.enabled           = false
        docker.enabled          = false
        singularity.enabled     = false
        podman.enabled          = false
        charliecloud.enabled    = false
        apptainer.enabled       = false
    }
    charliecloud {
        charliecloud.enabled    = true
        includeConfig 'conf/container.config'
        conda.enabled           = false
        docker.enabled          = false
        singularity.enabled     = false
        podman.enabled          = false
        shifter.enabled         = false
        apptainer.enabled       = false
    }
    apptainer {
        apptainer.enabled       = true
        apptainer.autoMounts    = true
        includeConfig 'conf/container.config'
        apptainer.cacheDir = params.image_cachedir
        conda.enabled           = false
        docker.enabled          = false
        singularity.enabled     = false
        podman.enabled          = false
        shifter.enabled         = false
        charliecloud.enabled    = false
    }
    wave {
        apptainer.ociAutoPull   = true
        singularity.ociAutoPull = true
        wave.enabled            = true
        wave.freeze             = true
        wave.strategy           = 'conda,container'
    }
    gitpod {
        executor.name           = 'local'
        executor.cpus           = 4
        executor.memory         = 8.GB
    }
    test      { includeConfig 'conf/test.config'      }
    test_full { includeConfig 'conf/test_full.config' }
}