Welcome to mSigHdp mutational signature extraction pipeline. For any questions, please consort the original paper (Liu et al. 2023, https://doi.org/10.1093/nargab/lqad005), GitHub/manual: (https://github.com/steverozen/mSigHdp/blob/v2.1.2-branch/mSigHdp_2.1.2.pdf), or the Stratton group. 

You have selected Analysis - please note that this is intended to be run on Lustre as it requires 20 CPUs.
Importing user datasets and conducting necessary data wrangling.
Sample key provided. Incorporating into mutational matrix.
Successfully imported datasets and completed data wrangling. Proceeding with mSigHdp analysis run.
Creating output subdirectory for run
Executing mSigHdp with 100 burn-in iterations, using a 10x multiplier. Collecting 10 posterior samples. Collecting 10 iterations between samples.
277 samples in United Kingdom
1 samples in Malawi
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
277 samples in United Kingdom
1 samples in Malawi
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
107 samples in China
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China

------------------------------------------------------------
Sender: LSF System <lsfadmin@node-13-10>
Subject: Job 154434: <nf-mSigHdp> in cluster <farm22> Exited

Job <nf-mSigHdp> was submitted from host <farm22-head1> by user <ar39> in cluster <farm22> at Sun Jul 20 08:17:26 2025
Job was executed on host(s) <node-13-10>, in queue <small>, as user <ar39> in cluster <farm22> at Sun Jul 20 08:17:27 2025
</nfs/users/nfs_a/ar39> was used as the home directory.
</lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/1b/d048712df6bbdb0094ac52abf2f43d> was used as the working directory.
Started at Sun Jul 20 08:17:27 2025
Terminated at Sun Jul 20 08:17:36 2025
Results reported at Sun Jul 20 08:17:36 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/bash
#BSUB -o /lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/1b/d048712df6bbdb0094ac52abf2f43d/.command.log
#BSUB -q small
#BSUB -J nf-mSigHdp
NXF_CHDIR=/lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/1b/d048712df6bbdb0094ac52abf2f43d
### ---
### name: 'mSigHdp'
### container: '/lustre/scratch125/casm/teams/team267/projects/DockerImages/msighdp_amd64_0.0.2.sif'
### outputs:
### - 'deNovo_signatures'
### - 'deNovo_signatures/mSigHdp_deNovoSignatures.txt'
### - 'deNovo_signatures/low.confidence.signatures.csv'
### ...
set -e
set -u
NXF_DEBUG=${NXF_DEBUG:=0}; [[ $NXF_DEBUG > 1 ]] && set -x
NXF_ENTRY=${1:-nxf_main}

nxf_container_env() {
cat << EOF
export PATH="\$PATH:/lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/bin"
EOF
}

nxf_sleep() {
  sleep $1 2>/dev/null || sleep 1;
}

nxf_date() {
    local ts=$(date +%s%3N);
    if [[ ${#ts} == 10 ]]; then echo ${ts}000
    elif [[ $ts == *%3N ]]; then echo ${ts/\%3N/000}
    elif [[ $ts == *3N ]]; then echo ${ts/3N/000}
    elif [[ ${#ts} == 13 ]]; then echo $ts
    else echo "Unexpected timestamp value: $ts"; exit 1
    fi
}

nxf_env() {
    echo '============= task environment ============='
    env | sort | sed "s/\(.*\)AWS\(.*\)=\(.\{6\}\).*/\1AWS\2=\3xxxxxxxxxxxxx/"
    echo '============= task output =================='
}

nxf_kill() {
    declare -a children
    while read P PP;do
        children[$PP]+=" $P"
    done < <(ps -e -o pid= -o ppid=)


(... more ...)
------------------------------------------------------------

TERM_MEMLIMIT: job killed after reaching LSF memory usage limit.
Exited with exit code 130.

Resource usage summary:

    CPU time :                                   8.00 sec.
    Max Memory :                                 1625 MB
    Average Memory :                             406.25 MB
    Total Requested Memory :                     -
    Delta Memory :                               -
    Max Swap :                                   -
    Max Processes :                              32
    Max Threads :                                47
    Run time :                                   9 sec.
    Turnaround time :                            10 sec.

The output (if any) is above this job summary.

