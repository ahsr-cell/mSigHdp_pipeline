Welcome to mSigHdp mutational signature extraction pipeline. For any questions, please consort the original paper (Liu et al. 2023, https://doi.org/10.1093/nargab/lqad005), GitHub/manual: (https://github.com/steverozen/mSigHdp/blob/v2.1.2-branch/mSigHdp_2.1.2.pdf), or the Stratton group. 

You have selected Analysis - please note that this is intended to be run on Lustre as it requires 20 CPUs.
Importing user datasets and conducting necessary data wrangling.
Sample key provided. Incorporating into mutational matrix.
Successfully imported datasets and completed data wrangling. Proceeding with mSigHdp analysis run.
Creating output subdirectory for run
Executing mSigHdp with 100 burn-in iterations, using a 10x multiplier. Collecting 10 posterior samples. Collecting 10 iterations between samples.
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
277 samples in United Kingdom
1 samples in Malawi
277 samples in United Kingdom
1 samples in Malawi
26 samples in Iran
26 samples in Iran
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China
23 samples in Brazil
5 samples in Kenya
43 samples in Canada
4 samples in Colombia
107 samples in China

------------------------------------------------------------
Sender: LSF System <lsfadmin@node-12-3-3>
Subject: Job 458364: <nf-mSigHdp> in cluster <farm22> Exited

Job <nf-mSigHdp> was submitted from host <node-12-4-3> by user <ar39> in cluster <farm22> at Wed Jul 23 04:24:57 2025
Job was executed on host(s) <node-12-3-3>, in queue <small>, as user <ar39> in cluster <farm22> at Wed Jul 23 04:24:57 2025
</nfs/users/nfs_a/ar39> was used as the home directory.
</lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/8b/6475d4a35e581e1854cfe59ba2d6a1> was used as the working directory.
Started at Wed Jul 23 04:24:57 2025
Terminated at Wed Jul 23 04:26:46 2025
Results reported at Wed Jul 23 04:26:46 2025

Your job looked like:

------------------------------------------------------------
# LSBATCH: User input
#!/bin/bash
#BSUB -o /lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/8b/6475d4a35e581e1854cfe59ba2d6a1/.command.log
#BSUB -q small
#BSUB -M 8192
#BSUB -R "select[mem>=8192] rusage[mem=8192]"
#BSUB -J nf-mSigHdp
NXF_CHDIR=/lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/test_run/work/8b/6475d4a35e581e1854cfe59ba2d6a1
### ---
### name: 'mSigHdp'
### container: '/lustre/scratch125/casm/teams/team267/projects/DockerImages/msighdp_amd64_0.0.2.sif'
### outputs:
### - 'deNovo_signatures'
### - 'deNovo_signatures/mSigHdp_deNovoSignatures.txt'
### - 'deNovo_signatures/low.confidence.signatures.csv'
### ...
set -e
set -u
NXF_DEBUG=${NXF_DEBUG:=0}; [[ $NXF_DEBUG > 1 ]] && set -x
NXF_ENTRY=${1:-nxf_main}

nxf_container_env() {
cat << EOF
export PATH="\$PATH:/lustre/scratch125/casm/teams/team267/projects/Pipelines/mSigHdp_pipeline/bin"
EOF
}

nxf_sleep() {
  sleep $1 2>/dev/null || sleep 1;
}

nxf_date() {
    local ts=$(date +%s%3N);
    if [[ ${#ts} == 10 ]]; then echo ${ts}000
    elif [[ $ts == *%3N ]]; then echo ${ts/\%3N/000}
    elif [[ $ts == *3N ]]; then echo ${ts/3N/000}
    elif [[ ${#ts} == 13 ]]; then echo $ts
    else echo "Unexpected timestamp value: $ts"; exit 1
    fi
}

nxf_env() {
    echo '============= task environment ============='
    env | sort | sed "s/\(.*\)AWS\(.*\)=\(.\{6\}\).*/\1AWS\2=\3xxxxxxxxxxxxx/"
    echo '============= task output =================='
}

nxf_kill() {
    declare -a children
    while read P PP;do
        children[$PP]+=" $P"

(... more ...)
------------------------------------------------------------

TERM_MEMLIMIT: job killed after reaching LSF memory usage limit.
Exited with exit code 130.

Resource usage summary:

    CPU time :                                   100.00 sec.
    Max Memory :                                 8612 MB
    Average Memory :                             4503.50 MB
    Total Requested Memory :                     8192.00 MB
    Delta Memory :                               -420.00 MB
    Max Swap :                                   -
    Max Processes :                              32
    Max Threads :                                47
    Run time :                                   109 sec.
    Turnaround time :                            109 sec.

The output (if any) is above this job summary.

