# mSigHdp_pipeline: Output

## Introduction

The directories listed below will be created in the results directory after the pipeline has finished. All paths are relative to the top-level results directory.

## Pipeline output overview

The pipeline is built using [Nextflow](https://www.nextflow.io/) and processes data using the following steps:

- [deNovo_signatures](#deNovo_signatures) - mSigHdp run
- [Signature_Spectra](#Signature_Spectra) - SigProfilerPlotting spectra
- [SigProfilerDecomposition](#SigProfilerDecomposition) - SigProfilerAssignment decomposition

### mSigHdp output
- `deNovo_signatures/`
  - `diagnostics.components.in.which.gibbs.samples.pdf`
  - `diagnostics.likelihood.pdf`
  - `diagnostics.numcluster.pdf`
  - `diagnostics.signatures.pdf`
  - `extracted.signatures.csv`: extracted de novo signatures matrix 
  - `extracted.signatures.post.samp.number.csv`
  - `hdp.retval.Rdata`
  - `inferred.exposure.count.pdf`
  - `inferred.exposure.proportion.pdf` 
  - `inferred.exposures.csv`
  - `low.confidence.signatures.csv`: low confidence extracted de novo signatures matrix
  - `low.confidence.signatures.post.samp.number.csv`
  - `mSigHdp_deNovoSignatures.txt`: formatted de novo signatures matrix used as input for SigProfilerPlotting
  - `mSigHdp_deNovoSigs_sigPADecomp.txt`: formatted de no
  - `mSigHdp_lowConfSignatures.txt`: formatted low confidence de novo signatures matrix used as input into SigProfilerPlotting

### SigProfilerPlotting output
- `Signature_Spectra/`
  - `DeNovoSignatures/`
    - `pkl/`
      - `*.pkl`: pickle file generated by SigProfilerPlotting
    - `*_plots_deNovoSignatures.pdf`: extracted de novo signature mutation spectra
  - `LowConfidenceSignatures/`
    - `pkl/`
      - `*.pkl` : pickle file generated by SigProfilerPlotting
    - `*_plots_LowConfidenceSignatures.pdf`: Low confidence signature mutation spectra plots
*Note - for files with the * wildcard character, they will be filled dynamically, according to user-unputted mutation signature context (i.e., specified via `--mutational_context`; e.g., SBS96, DBS78, ID83, etc.)

### SigProfilerAssignment output
- `SigProfilerDecomposition/`
  - `Decompose_Solution/`
    - `Activities/`
      - `Decompose_Solution_Activities.txt`
      - `Decompose_Solution_Activity_Plots.pdf`
      - `Decompose_Solution_TMB_plot.pdf`
      - `Decomposed_MutationType_Probabilities.txt`
    - `Signatures/`
      - `Decompose_Solution_Activities.txt`
      - `SBS_96_plots_Decompose_Solution.pdf`
    - `Solution_Stats/`
      - `Cosmic_SBS96_Decomposition_Log.txt`
      - `Decompose_Solution_Samples_Stats.txt`
      - `Decompose_Solution_Signature_Assignment_log.txt`
    - `De_Novo_map_to_COSMIC_SBS96.csv`
    - `SBS96_Decomposition_Plots.pdf`     
  - `pkl/`
    - `CosmicTemplates/`
      - `COSMIC_v3.4_SBS_GRCH38.json`
    - `SBS96.pkl`
  - `JOB_METADATA_SPA.txt/`